"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.slowDurationAndFpsState = void 0;
const slowDurationAndFpsState = () => {
    let smallestSample;
    let largestSample;
    let samples = 0;
    const getSlowDurationInSeconds = () => {
        if (smallestSample !== undefined && largestSample !== undefined) {
            const startingTimestampDifference = largestSample - smallestSample;
            const timeBetweenSamples = startingTimestampDifference / (samples - 1);
            return timeBetweenSamples * samples;
        }
        throw new Error('No samples');
    };
    return {
        addSample: (videoSample) => {
            samples++;
            const presentationTimeInSeconds = videoSample.cts / videoSample.timescale;
            if (largestSample === undefined ||
                presentationTimeInSeconds > largestSample) {
                largestSample = presentationTimeInSeconds;
            }
            if (smallestSample === undefined ||
                presentationTimeInSeconds < smallestSample) {
                smallestSample = presentationTimeInSeconds;
            }
        },
        getSlowDurationInSeconds,
        getFps: () => {
            return samples / getSlowDurationInSeconds();
        },
        getSlowNumberOfFrames: () => samples,
    };
};
exports.slowDurationAndFpsState = slowDurationAndFpsState;
